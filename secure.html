<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMA_SECURE | Vault 237</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #050608; color: #fff; font-family: sans-serif; padding: 20px; }
        .vault-card { max-width: 500px; margin: 30px auto; background: rgba(255,255,255,0.02); border: 1px solid #D4AF37; padding: 30px; border-radius: 15px; box-shadow: 0 0 30px rgba(212,175,55,0.1); }
        input, textarea { width: 100%; background: #000; border: 1px solid #333; padding: 12px; color: #fff; margin-bottom: 15px; border-radius: 5px; }
        .btn-gold { background: #D4AF37; color: #000; width: 100%; padding: 12px; border: none; font-weight: bold; cursor: pointer; border-radius: 5px; transition: 0.3s; }
        .btn-gold:hover { background: #fff; box-shadow: 0 0 15px #D4AF37; }
        .secret-item { background: #111; padding: 15px; margin-top: 10px; border-left: 3px solid #00FF41; border-radius: 4px; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        #accessDenied { text-align: center; margin-top: 100px; color: #ff4444; display: none; }
    </style>
</head>
<body>

    <div id="vaultContent" style="display: none;">
        <div class="vault-card">
            <h2 style="color:#D4AF37; text-align: center;"><i class="fas fa-user-shield"></i> SAMA_VAULT</h2>
            <p style="font-size: 0.7rem; text-align: center; color: #666; margin-bottom: 20px;">CRYPTO-NOTES SÉCURISÉES</p>
            
            <input type="text" id="titre" placeholder="Titre du secret">
            <textarea id="noteSecret" placeholder="Note confidentielle..." rows="4"></textarea>
            
            <button class="btn-gold" onclick="saveSecret()">SÉCURISER DANS LA BASE</button>

            <div id="secretsDisplay">
                </div>
        </div>
    </div>

    <div id="accessDenied">
        <i class="fas fa-lock" style="font-size: 3rem;"></i>
        <h2>ACCÈS RÉVOQUÉ</h2>
        <p>Clé Maître incorrecte.</p>
        <button onclick="location.reload()" class="btn-gold" style="width:auto; padding: 10px 20px; margin-top: 20px;">Réessayer</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBfpzKXEXtKOCoM3pYE-gHYdRv3u1B47fE",
            authDomain: "samamboa-5d546.firebaseapp.com",
            projectId: "samamboa-5d546",
            storageBucket: "samamboa-5d546.firebasestorage.app",
            appId: "1:23677970163:web:b99dc030affaf4c2eef986"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- SYSTÈME DE VÉRIFICATION ---
        const masterKey = prompt("AUTHENTIFICATION SAMA_SECURE : Entrez la Clé Maître");

        if(masterKey && masterKey.toUpperCase() === "MBOA2026") {
            document.getElementById('vaultContent').style.display = 'block';
            startVault();
        } else {
            document.getElementById('accessDenied').style.display = 'block';
        }

        function startVault() {
            // ENREGISTRER
            window.saveSecret = async () => {
                const titre = document.getElementById('titre').value;
                const texte = document.getElementById('noteSecret').value;
                if(!titre || !texte) return alert("Remplis les champs !");
                
                try {
                    await addDoc(collection(db, "vault_secrets"), {
                        titre: titre,
                        texte: texte,
                        date: new Date()
                    });
                    document.getElementById('titre').value = "";
                    document.getElementById('noteSecret').value = "";
                } catch(e) { alert("Erreur de connexion base"); }
            };

            // LIRE EN TEMPS RÉEL
            onSnapshot(query(collection(db, "vault_secrets"), orderBy("date", "desc")), (snap) => {
                const disp = document.getElementById('secretsDisplay');
                disp.innerHTML = "<h3 style='margin-top:25px; font-size:0.9rem; color:#888;'>ARCHIVES DÉCRYPTÉES :</h3>";
                snap.forEach(doc => {
                    const s = doc.data();
                    disp.innerHTML += `
                        <div class="secret-item">
                            <strong style="color:#D4AF37">${s.titre}</strong>
                            <p style="font-size:0.85rem; margin-top:5px; color:#ccc;">${s.texte}</p>
                            <span style="font-size:0.6rem; color:#444;">${new Date(s.date.seconds * 1000).toLocaleString()}</span>
                        </div>`;
                });
            });
        }
    </script>
</body>
</html>